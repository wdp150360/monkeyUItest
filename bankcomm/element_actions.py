import json
from . import random_s


class WebPageParseList:

    def __init__(self, source_str):
        self.source_str = source_str

    def parse_source_list(self):
        source_dict = json.loads(self.source_str)
        source_list = []
        if source_dict:
            node_info = {
                'package': source_dict.get('package', None),
                'enabled': source_dict.get('enabled', None),
                'scrollable': source_dict.get('scrollable', None),
                'bounds': source_dict.get('bounds', None)
            }
            source_list.append(node_info)
            node = source_dict.get('node', None)
            if node:
                source_list = get_node_info(node, source_list)

        return source_list


def get_node_info(node, source_list):
    if isinstance(node, dict):
        source_list = generate_node_info_dict(node, source_list)
    elif isinstance(node, list):
        for info in node:
            source_list = generate_node_info_dict(info, source_list)
    else:
        pass

    return source_list


def generate_node_info_dict(node, source_list):
    node_info = {
        'package': node.get('package', None),
        'enabled': node.get('enabled', None),
        'scrollable': node.get('scrollable', None),
        'bounds': node.get('bounds', None),
    }
    source_list.append(node_info)
    children_node = node.get('node', None)
    if children_node:
        source_list = get_node_info(children_node, source_list)

    return source_list


def touch_action(wd, node):

    pass


def slide_action(wd):
    pass



if '__main__' == __name__:
    str = """
{"index":"0","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,0][1080,2068]","node":{"index":"0","class":"android.widget.LinearLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,0][1080,2068]","node":{"index":"0","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","resource-id":"com.bankcomm:id/action_bar_root","class":"android.widget.LinearLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","resource-id":"android:id/content","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":[{"index":"0","resource-id":"com.bankcomm:id/srl_vertical_video","class":"android.view.ViewGroup","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"1","resource-id":"com.bankcomm:id/rv_vertical_video_list","class":"android.support.v7.widget.RecyclerView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"true","focused":"false","scrollable":"true","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.view.ViewGroup","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":[{"index":"0","resource-id":"com.bankcomm:id/rl_vertical_cover","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":[{"index":"0","class":"android.widget.ImageView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]"},{"index":"1","resource-id":"com.bankcomm:id/iv_vertical_cover","class":"android.widget.ImageView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]"}]},{"index":"1","resource-id":"com.bankcomm:id/vertical_player","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":[{"index":"0","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]"},{"NAF":"true","index":"1","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]"}}]}}},{"index":"2","resource-id":"com.bankcomm:id/cl_vertical_touch","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":[{"index":"0","resource-id":"com.bankcomm:id/rv_horizontal_scroll","class":"android.support.v7.widget.RecyclerView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"true","focused":"false","scrollable":"true","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","class":"android.widget.FrameLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,203][1080,2068]","node":{"index":"0","class":"com.tencent.tbs.core.webkit.WebView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,203][1080,2068]","node":{"index":"0","text":"竖屏直播","class":"android.webkit.WebView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"true","focused":"true","scrollable":"true","long-clickable":"false","password":"false","selected":"false","bounds":"[0,203][1080,2068]","node":[{"index":"0","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,203][1080,2068]","node":[{"index":"0","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[41,260][266,326]","node":[{"index":"0","class":"android.widget.Image","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[57,277][85,304]"},{"index":"1","text":" ","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[85,271][96,315]"},{"index":"2","text":"内容介绍","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[93,271][250,315]"}]},{"index":"1","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[41,1413][635,1847]"},{"index":"2","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,2004][1080,2068]","node":{"index":"0","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,2004][1080,2068]","node":[{"NAF":"true","index":"0","class":"android.widget.Image","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[41,2034][123,2068]"},{"NAF":"true","index":"1","class":"android.widget.Image","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[181,2034][266,2068]"},{"index":"2","text":"我来说几句...","class":"android.widget.EditText","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[324,2034][756,2068]"},{"NAF":"true","index":"3","class":"android.widget.Image","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[814,2034][899,2068]"},{"NAF":"true","index":"4","class":"android.widget.Image","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[957,2034][1039,2068]"}]}},{"index":"3","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[437,203][643,205]","node":{"index":"0","class":"android.widget.Image","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[437,203][643,205]"}}]},{"index":"1","text":"javascript:void(0)","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,203][1080,2068]"},{"index":"2","resource-id":"__vconsole","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[797,2034][1053,2068]","node":{"index":"0","text":"vConsole","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[797,2034][1053,2068]"}}]}}}}},{"index":"1","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","resource-id":"com.bankcomm:id/vertical_progress_switch","class":"android.view.View","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,841][1080,1391]"}}]}]}}},{"index":"1","resource-id":"com.bankcomm:id/rl_web_float_anim","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":{"index":"0","resource-id":"com.bankcomm:id/video_thumbs_up_anim","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]","node":[{"index":"0","resource-id":"com.bankcomm:id/float_anim_layout","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,2068]"},{"NAF":"true","index":"1","resource-id":"com.bankcomm:id/iv_thumbs_up_click","class":"android.widget.ImageView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[808,2034][901,2068]"}]}},{"index":"2","resource-id":"com.bankcomm:id/webview_header_toolbar","class":"android.widget.RelativeLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][1080,203]","node":[{"index":"0","class":"android.widget.LinearLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[0,82][127,203]","node":{"NAF":"true","index":"0","resource-id":"com.bankcomm:id/web_icon_left1","class":"android.widget.ImageView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[17,82][127,203]"}},{"index":"1","resource-id":"com.bankcomm:id/web_navbar_title_container","class":"android.widget.LinearLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[354,82][725,203]","node":{"index":"0","text":"lgp竖屏直播-预告","resource-id":"com.bankcomm:id/webview_header_title","class":"android.widget.TextView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[354,111][725,174]"}},{"index":"2","class":"android.widget.LinearLayout","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"false","enabled":"true","focusable":"false","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[826,82][1080,203]","node":[{"NAF":"true","index":"0","resource-id":"com.bankcomm:id/web_icon_right1","class":"android.widget.ImageView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[826,82][936,203]"},{"NAF":"true","index":"1","resource-id":"com.bankcomm:id/web_icon_right2","class":"android.widget.ImageView","package":"com.bankcomm","checkable":"false","checked":"false","clickable":"true","enabled":"true","focusable":"true","focused":"false","scrollable":"false","long-clickable":"false","password":"false","selected":"false","bounds":"[953,82][1063,203]"}]}]}]}}}}}}
    """
    listd = WebPageParseList(str)
    list_d = listd.parse_source_list()
    print(len(list_d))
